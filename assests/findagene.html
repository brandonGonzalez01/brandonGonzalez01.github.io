<!DOCTYPE html>
<html>
    
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />

    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Find a Gene</title>
  </head>

  <body>
    <div class="container p-2 m-4">
      <h1>Find a Gene</h1>
      <h3>Lets find a gene!</h3>
      <h4>Brandon Gonzalez, Winter 2019</h4>
    
    <div class="card m-4 p-2">
      <div class="card-body">
        <h5 class="card-title">Choosing a protein of interest</h5>
        <h6 class="card-subtitle mb-2 text-muted">
          We will choose a protein of interest to find in a different species. 
          Really this could be any protein of your choosing, but would be easier finding a new gene if it is not too highly conserved.
        </h6>
        <p class="card-text">
                <ul class="list-group list-group-flush">
                        <li class="list-group-item"><b>Name:</b> Amyloid-beta precursor protein</li>
                        <li class="list-group-item"> <b>Accession:</b> P05067</li>
                        <li class="list-group-item"><b>Species:</b> Homo Sapeins</li>
                        <li class="list-group-item">
                            <button type="button" class='btn btn-info' onclick="myFunction()"><b>FASTA:</b> </button>
                            <div id="myDIV" class>
                        <a href="https://www.uniprot.org/uniprot/P05067#sequences">
                            <b> >sp|P05067|A4_HUMAN Amyloid-beta precursor protein OS=Homo sapiens OX=9606 GN=APP PE=1 SV=3</b></a>
                                    <p>MLPGLALLLLAAWTARALEVPTDGNAGLLAEPQIAMFCGRLNMHMNVQNGKWDSDPSGTK
                                    TCIDTKEGILQYCQEVYPELQITNVVEANQPVTIQNWCKRGRKQCKTHPHFVIPYRCLVG
                                    EFVSDALLVPDKCKFLHQERMDVCETHLHWHTVAKETCSEKSTNLHDYGMLLPCGIDKFR
                                    GVEFVCCPLAEESDNVDSADAEEDDSDVWWGGADTDYADGSEDKVVEVAEEEEVAEVEEE
                                    EADDDEDDEDGDEVEEEAEEPYEEATERTTSIATTTTTTTESVEEVVREVCSEQAETGPC
                                    RAMISRWYFDVTEGKCAPFFYGGCGGNRNNFDTEEYCMAVCGSAMSQSLLKTTQEPLARD
                                    PVKLPTTAASTPDAVDKYLETPGDENEHAHFQKAKERLEAKHRERMSQVMREWEEAERQA
                                    KNLPKADKKAVIQHFQEKVESLEQEAANERQQLVETHMARVEAMLNDRRRLALENYITAL
                                    QAVPPRPRHVFNMLKKYVRAEQKDRQHTLKHFEHVRMVDPKKAAQIRSQVMTHLRVIYER
                                    MNQSLSLLYNVPAVAEEIQDEVDELLQKEQNYSDDVLANMISEPRISYGNDALMPSLTET
                                    KTTVELLPVNGEFSLDDLQPWHSFGADSVPANTENEVEPVDARPAADRGLTTRPGSGLTN
                                    IKTEEISEVKMDAEFRHDSGYEVHHQKLVFFAEDVGSNKGAIIGLMVGGVVIATVIVITL
                                    VMLKKKQYTSIHHGVVEVDAAVTPEERHLSKMQQNGYENPTYKFFEQMQN</p>
                            </div> 
                        </li>
                      </ul>
            </p>
        </div>
        </div>


    

    <div class="container-fluid pt-5 m-4">
            <h2><u> 1. Run a BLAST search using TBLASTN</u></h2>
            <h4>Lets find an unannotated nucleotide sequence.</h4>
            <P class="lead"> We run a TBLASTN because the APP FASTA sequence we are querying
                is a peptide sequence. It has to be <b>T</b>ranslated to a 
                <b>N</b>ucleotide sequence, hence the T and N in the TBLASTN</P>
        
                <table class="table">
                        <thead>
                          <tr>
                            <th scope="col"></th>
                            <th scope="col">Value</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <th scope="row">Database</th>
                            <td> Expressed Sequence Tags (est)</td>
                          </tr>
                          <tr>
                            <th scope="row">Method</th>
                            <td>TBLASTN (2.7.1) search against all excluding humans</td>
                          </tr>
                          <tr>  
                          <th scope="row">Organisms</th>
                            <td>All excluding humans</td>
                          </tr>
                        </tbody>
                      </table>
                      
                      <figure class="figure ptb-3">
                            <img src="../img/bsearch.jpg" class="figure-img img-fluid rounded" alt="...">
                            <figcaption class="figure-caption text-right">Figure 1: TBLASTN search query</figcaption>
                          </figure>
            </div>
            <div class="container-fluid ptb-3 m-4">
                
                <h4><u>Results</u></h4>
                <div class="container-fluid m-5">
                  <h5>Chosen match:</h5>Accession DY610640.1 <small class="text-muted">FASTA sequence shown below.</small>
                  <div class="container">
                          <dl class="row">
                                  <dt class="col-sm-3">Sequence:</dt>
                                  <dd class="col-sm-9">>DY610640.1 IMMUNEF045812H5 POSSUM_01-C-POSSUM-IMMUNE-2KB Trichosurus vulpecula cDNA clone 1061021068923, mRNA sequence
                                          GGCGGATGTGGTGGAAACCGAAACAACTTTGGCACTGAGGAATACTGCATGGCAGTCTGTGGCAGCATCA
                                          TCCCTACTACAGCAGCCAGCACCCCTGATGCTGTTGACAAATATCTGGAGACACCTGGTGATGAGAATGA
                                          ACATGCCCATTTCCAGAAAGCCAAAGAGAGACTCGAAGCCAAGCACCGTGAAAGAATGTCCCAGGTTATG
                                          AGGGAATGGGAAGAGGCAGAACATCAAGCAAAGAACCTGCCCAAAGCCGATAAGAAAGCAGTTATCCAGC
                                          ATTTCCAGGAAAAAGTGGAATCGTTAGAACAAGAAGCCGCAAACGAGAGGCAACAACTGGTGGAGACACA
                                          CATGGCCAGGGTCGAAGCTATGCTCAACGACCGTCGTCGTATGGCTCTGGAAAACTACATCACAGCCCTC
                                          CAGGCAGTTCCTCCACGGCCACGTCATGTATTCAACATGCTGAAGAAATATGTACGTGCTGAACAGAAAG
                                          ACAGGCAACATACCTTAAAGCATTTTGAACATGTTCGTATGGTGGATCCAAAGAAAGCTGCCCAAATCAG
                                          ATCTCAGGTCATGACACACTTGCGTGTGATTTATGAGAGGATGAACCAGTCCCTCTCTCTGCTCTACAAT
                                          GTGCCAGCAGTAGCTGAGGAGATTCAGGATGAAGTTGATGAGCTGCTTCAGAAAGAGCAAAACTACTCAG
                                          ATGATGTCTTGGCCAACATGATCAGTGAACCCAGGATCAGTTACGGAAATGATGCCCTCATGCCATCCCT
                                          GACTGAAACCAAAACCACAGTGGAACTCCTTCCAGTTGACGGAGAATTCAGCTTAGACGATCTGCAGCCA
                                          TGGCATCCTTTTGGTGTGATTCTGTTCCAGCTAATACNGAAAATGAAGTTGAGCCTGTTGATGCCCNCCC
                                          TGCTGCTGACNNAGGAC
                                      </dd>
                          </dl>
              </div>
                <div class="container">
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">Alignment Details</th>
                            <th scope="col">Value</th>
                        </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">Score</th>
                                <td>568 bits(1464)</td>
                            </tr>
                            <tr>
                                <th scope="row">Expect</th>
                                <td>0.0</td>
                            </tr>
                            <tr>
                                <th scope="row">Method</th>
                                <td>Compositional matrix adjust.</td>
                            </tr>
                            <tr>
                            <th scope="row">Identities</th>
                                <td>278/305(91%)</td>
                            </tr>
                            <tr>
                            <th scope="row">Positives
                            </th>
                            <td>
                              281/305(92%)
                            </td>
                         </tr>
                            <tr>
                                <th scope="row">Gaps</th>
                                <td>19/305 (6%)</td>                                    
                            </tr>
                            <tr>
                                <th scope="row">Frame</th>
                                <td>+1</td>                    
                            </tr>
                        </tbody>
                    </thead>
                </table>
            </div>
            </div>
            
            <h3>2. Translating the Unknown Target Sequence</h3><small class="text-muted p-4"> The chosen sequence is from 
                <a href="https://www.google.com/search?q=trichosurus+vulpecula&rlz=1C1CHBF_enUS794US794&source=lnms&tbm=isch&sa=X&ved=0ahUKEwjykeyAjf3gAhXwFzQIHQTQDFgQ_AUIDigB&biw=1421&bih=722">
                    Trichosurus vulpecula, a common bushtail possum. ... I guess they're kinda cute?</a> </small>

            <p class="p-4">Why translate? We need to translate the bushtail possum's nucleotice sequence to a protein sequence so we can check if the protein has been annotated before. Lets use
                <a href="https://www.ebi.ac.uk/Tools/st/emboss_transeq/">EMBOSS transeq.</a></p>

            <div class="container m-5">
                        <dl class="row">
                                <dt class="col-sm-3">Translated Sequence of DY610640.1</dt>
                                <dd class="col-sm-9">>EMBOSS_001_1
                                        GGCGGNRNNFGTEEYCMAVCGSIIPTTAASTPDAVDKYLETPGDENEHAHFQKAKERLEA
                                        KHRERMSQVMREWEEAEHQAKNLPKADKKAVIQHFQEKVESLEQEAANERQQLVETHMAR
                                        VEAMLNDRRRMALENYITALQAVPPRPRHVFNMLKKYVRAEQKDRQHTLKHFEHVRMVDP
                                        KKAAQIRSQVMTHLRVIYERMNQSLSLLYNVPAVAEEIQDEVDELLQKEQNYSDDVLANM
                                        ISEPRISYGNDALMPSLTETKTTVELLPVDGEFSLDDLQPWHPFGV
                                        
                                    </dd>
                        </dl>
            </div>    
            <div class="container"> <p>We now query this protein sequence in TBLASTN: 
                    I did two queries: one with all species where there were multiple hits of the protein in different
                    species as shown in figure 2. The second query was limited to Trichosurus V., there were no hits for Trichosurus V.
                    <b>No hits mean it has not been annotated before!</b>
                    </p>
                
                

                </div>
           
    <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="../img/tvresults.jpg" class="d-block w-100" alt="Figure 2 - Sample results of first tblastn query">
      <div class="carousel-caption d-none d-md-block text-secondary">
            <h5>Figure 2 – Sample of search results against all organisms</h5>
            <p>Protein hits for this nucleotide sequence related to APP</p>
          </div>
    </div>
    <div class="carousel-item">
      <img src="../img/tvresultstv.jpg" class="d-block w-100" alt="Figure 3 – Second search query limited to Trichosurus Vulpecula">
      <div class="carousel-caption d-none d-md-block text-secondary bg-dark text-light">
          <h5>Figure 3 – Second search query limited to Trichosurus Vulpecula</h5>
          <p>No protein hits for this nucleotide sequence</p>
        </div>
 
    </div>
  </div>
  <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon bg-dark" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
    <span class="carousel-control-next-icon bg-dark" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>

<div class="container-fluid p-4">
<h2> <u>3. Choosing sequences to compare against</u></h2>
<div class="container-fluid m-5">
   
    <p>With these sequences we will generate a heat map and a phlyogeny</p>
    <p>Sequences to compare against: </p>
    <ul class="list-group-flush text-secondary">
            <li class="list-group-item">Our target sequence: T_Vulpecula_blast_query</li>
            <li class="list-group-item">>Human NP_000475.1 amyloid-beta precursor protein isoform a precursor [Homo sapiens]</li>
            <li class="list-group-item">>Common_chimp NP_001013036.1 amyloid-beta A4 protein precursor [Pan troglodytes]</li>
            <li class="list-group-item">>Hornbill_bird XP-PREDICTEDamyloidbetaAproteinisoformXBucerosrhinoceros
                    Silvestris
                    </li>
            <li class="list-group-item">>Aardvark XP_007941686.1 PREDICTED: amyloid beta A4 protein isoform X4 </li>
            <li class="list-group-item">>CommonWombat_A4_X1 XP_027731255.1 amyloid-beta A4 protein isoform X1 [Vombatus ursinus]</li>
            <li class="list-group-item">> CommonWombat_A4_X2  XP_027731256.1 amyloid-beta A4 protein isoform X2 [Vombatus ursinus]</li>
            <li class="list-group-item">>TasmanianDevil_A4_X1 XP_012402203.1 amyloid-beta A4 protein isoform X1 [Sarcophilus harrisii]</li>
            <li class="list-group-item">>TasmanianDevil_A4_X2 XP_023356729.1 amyloid-beta A4 protein isoform X2 [Sarcophilus harrisii]</li>
            <li class="list-group-item">>Koala_A4_X1 XP_020851503.1 amyloid beta A4 protein isoform X1 [Phascolarctos cinereus]</li>
            <li class="list-group-item">>Koala_A4_X2 XP_020851504.1 amyloid beta A4 protein isoform X2 [Phascolarctos cinereus]</li>
            <li class="list-group-item">>Koala_A4_X3 XP_023355322.1 amyloid-like protein 2 isoform X3 [Sarcophilus harrisii]</li>
            <li class="list-group-item">>Gr_shrtTl_opossum XP_007493449.1 PREDICTED: amyloid beta A4 protein</li>
            <li class="list-group-item">>Virginia_opossum_partial_protein ACU29451.1 amyloid beta (A4) precursor-like protein 2, partial [Didelphis virginiana]</li>
            <li class="list-group-item">>GrayShortTlOpossum_Pred.BetaA4 XP_007493449.1 PREDICTED: amyloid beta A4 protein [Monodelphis domestica]</li>
        </ul>
        <div class="alert alert-success" role="alert"> <p>The way way I rendered the heat map was running the sequences in 
            MUSCLE, a multiple sequence alignment algorithm. Then with R I made
             a sequence identity matrix and plotted that into a heatmap.</p></div>
       

        <figure class="figure ptb-3">
          <img src="../img/heatmap.jpg" class="figure-img img-fluid rounded" alt="heat map of sequences">
          <figcaption class="figure-caption text-right">Figure 4: TBLASTN search query</figcaption>
        </figure>

        <div class="container">
          <p>Lets get a consensus from the alignment with R, the default cutoff identity value is 0.6.
              With this consensus sequence we can query pdb to find protein structures that are similar.</p>
        
        <div class="container">
          <div class="row">
            <div class="col-sm">
              <p>Consensus Sequence:</p>
            </div>
            <div class="col">
               <p> >ConsensusSeq</p>
                <p> ------------------MLP----L-L--W---ALEV-TDGNAGLLAEPQIAM-CGKLN
                MHMNVQNGKWE-DPSGTKTCI--KEGILQYCQEVYPELQITNVVEANQPVTIQNWCKRGR
                KQCK--P-IVIPYRCLVGEFVSDALLVPDKCKFLHQERMD-CETHLHWHTVAKETCSEKS
                MNLH-YGMLLPCGIDKFRGVEFVCCPLA-E-DNVDSADAE-DDS-VWWGGAD-DYADGSD
                DKVVE--VAEEEEV-DVEDE--D---DD-DGDE--EE-EE-YEEATE-------------
                ---RTT--A--TTTTTTTESVEEVVR---------------------------------G
                GCGGNRNNF--E-YCMAVC-----------------------PTTAASTPDAVDKYLETP
                GDENEHAHFQKAKERLEAKHRERMSQVMREWEEAEHQAKNLPKADKKAVIQHFQEKVESL
                EQEAANERQQLVETHMARVEAMLNDRRR-ALENYITALQAVPPRPRHVFNMLKKYVRAEQ
                KDRQHTLKHFEHVRMVDPKKAAQIRSQVMTHLRVIYERMNQSLSLLYNVPAVAEEIQDEV
                DELLQKEQNYSDDVLANMISEPRISYGNDALMPSLTETKTTVELLPVDGEFSLDDLQPWH
                PFGVDSVPANTENEVEPVDARPAADRGLTT--RPGSGLTNIKTEEI-SEVKMDAEFRHDS
                GYEVHHQKLVFFAE-----------------D--SNKGAIIGLMVGG-VIATVIV-TLVM
                L-KKQYTSIHHGVVE-DAAVTPEERHLSKMQQNGYENPTYKFFEQMQN--
              </p>
              </p>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-sm">
            <p>Proteins from BlastP:
            <a href="proresult.html">Top three protein hits subset then written as csv and saved to html document.</a>
          </p>
        </div>
      </div>

      <div class="alert alert-info" role="alert"> 
        <p>Image of Protein 5BUO. We can confidentily estimate that the T.Vulpecula gene assignment protein is quite similar to this due to the sequence similarity.</p>
      </div>
     

      <figure class="figure ptb-3">
        <img src="../img/5buo.png" class="figure-img img-fluid rounded" alt="5BUO rendered in VMD">
        <figcaption class="figure-caption text-right">Figure 6: 5BUO</figcaption>
      </figure>
      


</div>
</div>

</div>

</div>

</body>
<script>
        function myFunction() {
          var x = document.getElementById("myDIV");
          if (x.style.display === "none") {
            x.style.display = "block";
          } else {
            x.style.display = "none";
          }
        }
        </script>
        
</html>
